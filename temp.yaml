AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: 'sam-app

  Sample SAM Template for sam-app

  '
Globals:
  Function:
    Timeout: 3
    MemorySize: 128
Resources:
  HelloWorldFunction:
    Type: AWS::Serverless::Function
    Properties:
      CodeUri: s3://aws-sam-cli-managed-default-samclisourcebucket-1vqwncfsr0gzh/sam-app/0c9fe3838e99c12ea4d4ff745f8888d5
      Handler: app.lambda_handler
      Runtime: python3.9
      Architectures:
      - x86_64
      Events:
        HelloWorld:
          Type: Api
          Properties:
            Path: /hello
            Method: get
    Metadata:
      SamResourceId: HelloWorldFunction
Outputs:
  HelloWorldApi:
    Description: API Gateway endpoint URL for Prod stage for Hello World function
    Value:
      Fn::Sub: https://${ServerlessRestApi}.execute-api.${AWS::Region}.amazonaws.com/Prod/hello/
  HelloWorldFunction:
    Description: Hello World Lambda Function ARN
    Value:
      Fn::GetAtt:
      - HelloWorldFunction
      - Arn
  HelloWorldFunctionIamRole:
    Description: Implicit IAM Role created for Hello World function
    Value:
      Fn::GetAtt:
      - HelloWorldFunctionRole
      - Arn


{"AWSTemplateFormatVersion":"2010-09-09","Description":"sam-app\nSample SAM Template for sam-app\n","Outputs":{"HelloWorldApi":{"Description":"API Gateway endpoint URL for Prod stage for Hello World function","Value":{"Fn::Sub":"https://${ServerlessRestApi}.execute-api.${AWS::Region}.amazonaws.com/Prod/hello/"}},"HelloWorldFunction":{"Description":"Hello World Lambda Function ARN","Value":{"Fn::GetAtt":["HelloWorldFunction","Arn"]}},"HelloWorldFunctionIamRole":{"Description":"Implicit IAM Role created for Hello World function","Value":{"Fn::GetAtt":["HelloWorldFunctionRole","Arn"]}}},"Resources":{"HelloWorldFunctionHelloWorldPermissionProd":{"Type":"AWS::Lambda::Permission","Properties":{"Action":"lambda:InvokeFunction","FunctionName":{"Ref":"HelloWorldFunction"},"Principal":"apigateway.amazonaws.com","SourceArn":{"Fn::Sub":["arn:aws:execute-api:${AWS::Region}:${AWS::AccountId}:${__ApiId__}/${__Stage__}/GET/hello",{"__ApiId__":{"Ref":"ServerlessRestApi"},"__Stage__":"*"}]}}},"HelloWorldFunctionRole":{"Type":"AWS::IAM::Role","Properties":{"AssumeRolePolicyDocument":{"Version":"2012-10-17","Statement":[{"Action":["sts:AssumeRole"],"Effect":"Allow","Principal":{"Service":["lambda.amazonaws.com"]}}]},"ManagedPolicyArns":["arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"],"Tags":[{"Key":"lambda:createdBy","Value":"SAM"}]}},"ServerlessRestApiProdStage":{"Type":"AWS::ApiGateway::Stage","Properties":{"DeploymentId":{"Ref":"ServerlessRestApiDeployment47fc2d5f9d"},"RestApiId":{"Ref":"ServerlessRestApi"},"StageName":"Prod"}},"ServerlessRestApiDeployment47fc2d5f9d":{"Type":"AWS::ApiGateway::Deployment","Properties":{"Description":"RestApi deployment id: 47fc2d5f9d21ad56f83937abe2779d0e26d7095e","RestApiId":{"Ref":"ServerlessRestApi"},"StageName":"Stage"}},"ServerlessRestApi":{"Type":"AWS::ApiGateway::RestApi","Properties":{"Body":{"info":{"version":"1.0","title":{"Ref":"AWS::StackName"}},"paths":{"/hello":{"get":{"x-amazon-apigateway-integration":{"httpMethod":"POST","type":"aws_proxy","uri":{"Fn::Sub":"arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${HelloWorldFunction.Arn}/invocations"}},"responses":{}}}},"swagger":"2.0"}}},"HelloWorldFunction":{"Type":"AWS::Lambda::Function","Metadata":{"SamResourceId":"HelloWorldFunction"},"Properties":{"Code":{"S3Bucket":"aws-sam-cli-managed-default-samclisourcebucket-1vqwncfsr0gzh","S3Key":"sam-app/0c9fe3838e99c12ea4d4ff745f8888d5"},"Handler":"app.lambda_handler","MemorySize":128,"Role":{"Fn::GetAtt":["HelloWorldFunctionRole","Arn"]},"Runtime":"python3.9","Timeout":3,"Tags":[{"Key":"lambda:createdBy","Value":"SAM"}],"Architectures":["x86_64"]}}}}

CREATE_IN_PROGRESS                     AWS::CloudFormation::Stack             sam-app                                User Initiated
CREATE_IN_PROGRESS                     AWS::IAM::Role                         HelloWorldFunctionRole                 -
CREATE_IN_PROGRESS                     AWS::IAM::Role                         HelloWorldFunctionRole                 Resource creation Initiated
CREATE_COMPLETE                        AWS::IAM::Role                         HelloWorldFunctionRole                 -
CREATE_IN_PROGRESS                     AWS::Lambda::Function                  HelloWorldFunction                     -
CREATE_IN_PROGRESS                     AWS::Lambda::Function                  HelloWorldFunction                     Resource creation Initiated
CREATE_COMPLETE                        AWS::Lambda::Function                  HelloWorldFunction                     -
CREATE_IN_PROGRESS                     AWS::ApiGateway::RestApi               ServerlessRestApi                      -
CREATE_IN_PROGRESS                     AWS::ApiGateway::RestApi               ServerlessRestApi                      Resource creation Initiated
CREATE_COMPLETE                        AWS::ApiGateway::RestApi               ServerlessRestApi                      -
CREATE_IN_PROGRESS                     AWS::ApiGateway::Deployment            ServerlessRestApiDeployment47fc2d5f9   -
                                                                              d
CREATE_IN_PROGRESS                     AWS::Lambda::Permission                HelloWorldFunctionHelloWorldPermissi   -
                                                                              onProd
CREATE_IN_PROGRESS                     AWS::Lambda::Permission                HelloWorldFunctionHelloWorldPermissi   Resource creation Initiated
                                                                              onProd
CREATE_COMPLETE                        AWS::Lambda::Permission                HelloWorldFunctionHelloWorldPermissi   -
                                                                              onProd
CREATE_IN_PROGRESS                     AWS::ApiGateway::Deployment            ServerlessRestApiDeployment47fc2d5f9   Resource creation Initiated
                                                                              d
CREATE_COMPLETE                        AWS::ApiGateway::Deployment            ServerlessRestApiDeployment47fc2d5f9   -
                                                                              d
CREATE_IN_PROGRESS                     AWS::ApiGateway::Stage                 ServerlessRestApiProdStage             -
CREATE_IN_PROGRESS                     AWS::ApiGateway::Stage                 ServerlessRestApiProdStage             Resource creation Initiated
CREATE_COMPLETE                        AWS::ApiGateway::Stage                 ServerlessRestApiProdStage             -
CREATE_COMPLETE                        AWS::CloudFormation::Stack             sam-app                                -